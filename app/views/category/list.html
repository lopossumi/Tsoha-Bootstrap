{% extends "base.html" %}
{% import "macros/forms.html" as forms %}

{% block content %}

{% if message is defined %}
<div class="alert alert-info">
    <a href="#" class="close" data-dismiss="alert" aria-label="close">&times;</a>
    {{message}}
</div>
{% endif %}

<table class="table">
    <!-- header -->
    <thead>
        <tr>
            <td colspan=6>
                <h2><button class="btn btn-default btn-{{myCategory.color}}"><span class="glyphicon glyphicon-{{myCategory.symbol}}"></span></button> {{myCategory.name}}</h2>
            </td>
        </tr>
        <tr>
            <th class="col-xs-1">Status</th>
            <th class="col-xs-1">Due</th>
            <th class="col-xs-2">Priority</th>
            <th class="col-xs-5">Name</th>
            <th class="col-xs-1">Categories</th>
            <th class="col-xs-2">Actions</th>
        </tr>
    </thead>


    <tbody>
        <!-- Tehtävälistaus -->
        {% for task in myTasks %}
        <tr class="
        {% if task.status == 2 %}success{% endif %}
        {% if task.status == 1 %}info{% endif %} 
        {% if task.archived %} hidden{% endif %}">
            
            <!-- Task status -->
            <td>
                {% if task.status == 2 %}
                    {{ forms.action_button("post", "#{base_path}/task/#{task.id}/archive", "Archive task", "success", "ok") }}
                {% elseif task.status == 1 %}
                    {{ forms.action_button("post", "#{base_path}/task/#{task.id}/complete", "Complete task", "info", "play") }}
                {% else %}
                    {{ forms.action_button("post", "#{base_path}/task/#{task.id}/start", "Start task", "default", "play") }}
                {% endif %}
            </td>
            
            <!-- Due deadline -->
            <td>
                {% if task.duedate and task.status == 0 %}
                    {{ forms.due_label(task.duedate) }}
                {% endif %}
            </td>

            <!-- Priority stars -->
            <td>
                {% for i in 1..4 %}
                    <span class="warning glyphicon glyphicon-star{% if i>task.priority %}-empty{% endif %}"></span>
                {% endfor %}
            </td>

            <!-- Task name -->
            <td>{{task.name}}</td>

            <!-- Categories -->
            <td>
                {% for category in task.categories %}
                {{ forms.category_button_xs("#{base_path}/category/#{category.id}/list","#{category.name}", 
                "#{category.color}", "#{category.symbol}") }}
                {% endfor %}
            </td>

            <!-- Edit & remove buttons -->
            <td>
                <div class="btn-toolbar">
                 {{ forms.edit_button("#{base_path}/task/#{task.id}/edit","Edit task")}}
                 {{ forms.remove_button("#{base_path}/task/#{task.id}/remove","Remove task") }}
                </div>
            </td>

        </tr>
           {% endfor %}
       </tbody>
   </table>

   {% endblock %}
