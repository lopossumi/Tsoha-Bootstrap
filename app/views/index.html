{% extends "base.html" %} {% import "macros/forms.html" as forms %} {% block content %}

<div class="panel-group" id="accordion" role="tablist" aria-multiselectable="true">
	{% for tasklist in myTasklists %}
	<div class="panel panel-default">
		<div class="panel-heading" role="tab" id="headingOne">
			<h4 class="panel-title">
				<a role="button" data-toggle="collapse" data-parent="#accordion" href="#collapse{{tasklist.id}}" aria-expanded="true" aria-controls="collapse{{tasklist.id}}">
                  <span class="label label-default">{{tasklist.name}}</span></a>
                </a>
			</h4>
		</div>
		
		<div id="collapse{{tasklist.id}}" class="panel-collapse collapse in" role="tabpanel" aria-labelledby="headingOne">
			<div class="panel-body">
				<table class="table" id="tasklist{{tasklist.id}}">
					<!-- Headers -->
					<thead>
						<tr>
							<th class="col-xs-1">Status</th>
							<th class="col-xs-1">Due</th>
							<th class="col-xs-2">Priority</th>
							<th class="col-xs-5">Name</th>
							<th class="col-xs-1">Categories</th>
							<th class="col-xs-2">Actions</th>
						</tr>
					</thead>
					<tbody>

						{% for task in tasklist.tasks %}
						<tr class="
        {% if task.status == 2 %}success{% endif %}
        {% if task.status == 1 %}info{% endif %} 
        {% if task.archived %} hidden{% endif %}">
							<!-- status -->
							<td data-order="{{task.status}}">
								{% if task.status == 2 %} {{ forms.action_button("post", "#{base_path}/task/#{task.id}/archive", "Archive task", "success",
								"ok") }} {% elseif task.status == 1 %} {{ forms.action_button("post", "#{base_path}/task/#{task.id}/complete", "Complete
								task", "info", "play") }} {% else %} {{ forms.action_button("post", "#{base_path}/task/#{task.id}/start", "Start
								task", "default", "play") }} {% endif %}
							</td>

							<!-- due deadline -->
							<td>
								{% if task.duedate and task.status == 0 %} {{ forms.due_label(task.duedate) }} {% endif %}
							</td>

							<!-- priority stars -->
							<td data-order="{{task.priority}}">
								{% for i in 1..4 %}
								<span class="warning glyphicon glyphicon-star{% if i>task.priority %}-empty{% endif %}"></span> {% endfor %}
							</td>

							<!-- task name -->
							<td>
								<a href="{{base_path}}/task/{{task.id}}/view">
									<div style="height:100%;width:100%">
										{{task.name}}
									</div>
								</a>
							</td>

							<!-- category -->
							<td>
								{% for category in task.categories %} {{ forms.category_button_xs("#{base_path}/category/#{category.id}/list","#{category.name}",
								"#{category.color}", "#{category.symbol}") }} {% endfor %}
							</td>

							<!-- edit & remove buttons -->
							<td>
								<div class="btn-toolbar">
									{{ forms.edit_button("#{base_path}/task/#{task.id}/edit","Edit task")}} {{ forms.remove_button("#{base_path}/task/#{task.id}/remove","Remove
									task") }}
								</div>
							</td>

						</tr>
					</tbody>
				</table>
			</div>
		</div>
	</div><!-- panel -->
	{% endfor %}
</div><!-- panel-group -->

	<!-- enable datatable -->
	<script type="text/javascript">
$(document).ready(function() {
    $('#tasklist{{tasklist.id}}').DataTable({
        paging: false,
        searching: false,
        info: false
    });
    $('.collapse').collapse()
} );
</script> {% endfor %} {% endblock %}